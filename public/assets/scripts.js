
(function(){var method;var noop=function(){};var methods=['assert','clear','count','debug','dir','dirxml','error','exception','group','groupCollapsed','groupEnd','info','log','markTimeline','profile','profileEnd','table','time','timeEnd','timeStamp','trace','warn'];var length=methods.length;var console=(window.console=window.console||{});while(length--){method=methods[length];if(!console[method]){console[method]=noop;}}}());$.fn.serializeObject=function(){var o={};var a=this.serializeArray();$.each(a,function(){if(o[this.name]!==undefined){if(!o[this.name].push){o[this.name]=[o[this.name]];}
o[this.name].push(this.value||'');}else{o[this.name]=this.value||'';}});return o;};_.templateSettings={interpolate:/\{\{(.+?)\}\}/g};var App=(function(){var Entry=Backbone.Model.extend({idAttribute:'_id'});var EntryList=Backbone.Collection.extend({model:Entry,url:'/entries'});var EntriesView=Backbone.View.extend({events:{'submit form':'submit'},submit:function(){var $form=this.$el.find('form');var data=$form.serializeObject();this.collection.create(data);$form[0].reset();return false;},initialize:function(){this.listenTo(this.collection,'reset',this.render);this.listenTo(this.collection,'add',this.add);},render:function(){this.collection.forEach(this.add,this);return this;},add:function(entry){$('.entries').prepend(new EntryView({model:entry}).render().el);}});var EntryView=Backbone.View.extend({tagName:"p",className:"entry bg-info",events:{'click .delete':'deleteEntry'},deleteEntry:function(){this.model.destroy();return false;},initialize:function(){this.listenTo(this.model,'destroy',this.remove);},template:_.template('{{title}}'+'<a href="#" class="delete"><span class="genericon genericon-trash"></span></a>'),render:function(){$(this.el).html(this.template(this.model.attributes));return this;}});var AppRouter=Backbone.Router.extend({routes:{'':'index'},initialize:function(){},index:function(){var entries=new EntryList();new EntriesView({el:'#entries',collection:entries});entries.fetch({reset:true});}});function init(){new AppRouter();Backbone.history.start();};return{init:init};}());$(function(){App.init();});